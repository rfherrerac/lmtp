<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Non-parametric Causal Effects of Feasible Interventions Based on Modified Treatment Policies • lmtp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Non-parametric Causal Effects of Feasible Interventions Based on Modified Treatment Policies">
<meta property="og:description" content="Non-parametric estimators for casual effects based on longitudinal modified treatment 
  policies as described in Diaz, Williams, and Hoffman (2020) &lt;arXiv:...&gt;, traditional point treatment, 
  and traditional longitudinal effects. Continuous, binary, and categorical treatments are allowed as well are 
  censored outcomes. The treatment mechanism is estimated via a density ratio classification procedure 
  irrespective of treatment variable type. Estimation is performed using the Super Learner from `sl3`. 
  For both continuous and binary outcomes, additive treatment effects can be calculated and relative 
  risks and odds ratios may be calculated for binary outcomes. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lmtp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.91</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/intro-lmtp.html">Getting Started with LMTP</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="lmtp-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lmtp-" class="anchor"></a>lmtp <img src="reference/figures/lmtp.png" align="right" height="139">
</h1></div>
<!-- badges: start -->

<blockquote>
<p>Non-parametric Causal Effects of Feasible Interventions Based on Modified Treatment Policies</p>
</blockquote>
<p><a href="https://nicholastwilliams.com">Nick Williams</a> and <a href="https://idiaz.xyz">Ivan Diaz</a></p>
<hr>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>lmtp</code> can be installed from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"nt-williams/lmtp"</span>)</pre></div>
</div>
<div id="scope" class="section level2">
<h2 class="hasAnchor">
<a href="#scope" class="anchor"></a>Scope</h2>
<p><code>lmtp</code> is an R package that provides an estimation framework for the casual effects of feasible interventions based on point-treatment and longitudinal modified treatment policies as described in Diaz, Williams, Hoffman, and Schenck (2020). Two primary estimators are supported, a targeted maximum likelihood (TML) estimator and a sequentially doubly robust (SDR) estimator (a G-computation and an inverse probability of treatment weighting estimator are provided for the sake of being thorough but their use is recommended against in favor of the TML and SDR estimators). Both binary and continuous outcomes (both with censoring) are allowed. <code>lmtp</code> is built atop the <a href="https://github.com/tlverse/sl3"><code>sl3</code></a> package to utilize ensemble machine learning for estimation. The treatment mechanism is estimated via a density ratio classification procedure irrespective of treatment variable type providing decreased computation time when treatment is continuous.</p>
<p>For an in-depth look at the package’s functionality, please consult the accompanying <a href="https://htmlpreview.github.io/?https://gist.githubusercontent.com/nt-williams/ddd44c48390b8d976fad71750e48d8bf/raw/c56a7b0bbdf24ec18d08f839e73fa06a42ca9265/intro-lmtp.html">vignette</a>.</p>
<div id="features" class="section level3">
<h3 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h3>
<table class="table">
<thead><tr class="header">
<th>Feature</th>
<th align="center">Status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Point treatment</td>
<td align="center">✓</td>
</tr>
<tr class="even">
<td>Longitudinal treatment</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Modified treatment intervention</td>
<td align="center">✓</td>
</tr>
<tr class="even">
<td>Static intervention</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Dynamic intervention</td>
<td align="center">Planned</td>
</tr>
<tr class="even">
<td>Continuous treatment</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Binary treatment</td>
<td align="center">✓</td>
</tr>
<tr class="even">
<td>Categorical treatment</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Missingness in treatment</td>
<td align="center"></td>
</tr>
<tr class="even">
<td>Continuous outcome</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Binary outcome</td>
<td align="center">✓</td>
</tr>
<tr class="even">
<td>Censored outcome</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Mediation</td>
<td align="center"></td>
</tr>
<tr class="even">
<td>Super learner</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Clustered data</td>
<td align="center">Planned</td>
</tr>
<tr class="even">
<td>Parallel processing</td>
<td align="center">✓</td>
</tr>
<tr class="odd">
<td>Progress bars</td>
<td align="center">✓</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lmtp</span>)
<span class="co">#&gt; lmtp: Causal Effects Based on Longitudinal Modified Treatment</span>
<span class="co">#&gt; Policies</span>
<span class="co">#&gt; Version: 0.0.91</span>
<span class="co">#&gt; </span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sl3</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">future</span>)

<span class="co"># the data: 4 treatment nodes with time varying covariates and a binary outcome</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sim_t4</span>)
<span class="co">#&gt;   ID L_1 A_1 L_2 A_2 L_3 A_3 L_4 A_4 Y</span>
<span class="co">#&gt; 1  1   2   3   0   1   1   1   1   3 0</span>
<span class="co">#&gt; 2  2   2   1   1   4   0   3   1   2 0</span>
<span class="co">#&gt; 3  3   1   0   1   3   1   2   1   1 1</span>
<span class="co">#&gt; 4  4   1   0   0   3   1   3   1   2 0</span>
<span class="co">#&gt; 5  5   3   3   1   1   0   1   1   2 0</span>
<span class="co">#&gt; 6  6   1   0   0   2   0   3   1   4 0</span></pre></div>
<p>We’re interested in a treatment policy, <code>d</code>, where exposure is decreased by 1 only among subjects whose exposure won’t go below 1 if intervened upon. The true population outcome under this policy is about 0.305.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># our treatment policy function to be applied at all time points</span>
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">a</span>) {
  (<span class="no">a</span> - <span class="fl">1</span>) * (<span class="no">a</span> - <span class="fl">1</span> <span class="kw">&gt;=</span> <span class="fl">1</span>) + <span class="no">a</span> * (<span class="no">a</span> - <span class="fl">1</span> <span class="kw">&lt;</span> <span class="fl">1</span>)
}</pre></div>
<p>In addition to specifying a treatment policy, we need to specify our treatment variables, time-varying covariates, and the <code>sl3</code> learners to be used in estimation.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co"># our treatment nodes, a character vector of length 4</span>
<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A_1"</span>, <span class="st">"A_2"</span>, <span class="st">"A_3"</span>, <span class="st">"A_4"</span>)
<span class="co"># our time varying nodes, a list of length 4</span>
<span class="no">time_varying</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L_1"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L_2"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L_3"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L_4"</span>))
<span class="co"># our sl3 learner stack: the mean, GLM, and random forest</span>
<span class="no">lrnrs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tlverse.org/sl3/reference/make_learner_stack.html">make_learner_stack</a></span>(<span class="no">Lrnr_mean</span>,
                            <span class="no">Lrnr_glm</span>,
                            <span class="no">Lrnr_ranger</span>)</pre></div>
<p>We can now estimate the effect of our treatment policy, <code>d</code>. In this example, we’ll use the cross-validated TML estimator with 10 folds. To speed up computation, we can use parallel processing supported by the <code>future</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(<span class="no">multiprocess</span>)

<span class="fu"><a href="reference/lmtp_tmle.html">lmtp_tmle</a></span>(<span class="no">sim_t4</span>, <span class="no">a</span>, <span class="st">"Y"</span>, <span class="kw">time_vary</span> <span class="kw">=</span> <span class="no">time_varying</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">shift</span> <span class="kw">=</span> <span class="no">d</span>,
          <span class="kw">learners_outcome</span> <span class="kw">=</span> <span class="no">lrnrs</span>, <span class="kw">learners_trt</span> <span class="kw">=</span> <span class="no">lrnrs</span>, <span class="kw">folds</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="co"># LMTP Estimator: TMLE</span>
<span class="co">#    Trt. Policy: (d)</span>
<span class="co"># </span>
<span class="co"># Population intervention effect</span>
<span class="co">#       Estimate: 0.2901</span>
<span class="co">#     Std. error: 0.0119</span>
<span class="co">#         95% CI: (0.2667, 0.3134)</span></pre></div>
</div>
<div id="similiar-implementations" class="section level2">
<h2 class="hasAnchor">
<a href="#similiar-implementations" class="anchor"></a>Similiar Implementations</h2>
<p>A variety of other R packages perform similiar tasks as <code>lmtp</code>. However, <code>lmtp</code> is the only R package currently capable of estimating causal effects for binary, categorical, and continuous outcomes in both the point treatment and longitudinal setting using traditional causal effects or modified treatment policies.</p>
<ul>
<li>
<a href="https://github.com/nhejazi/txshift"><code>txshift</code></a><br>
</li>
<li>
<a href="https://github.com/tlverse/tmle3"><code>tmle3</code></a><br>
</li>
<li><a href="https://github.com/tlverse/tmle3shift"><code>tmle3shift</code></a></li>
<li>
<a href="https://cran.r-project.org/web/packages/ltmle/index.html"><code>ltmle</code></a><br>
</li>
<li><a href="https://cran.r-project.org/web/packages/tmle/index.html"><code>tmle</code></a></li>
</ul>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>Please cite the following when using <code>lmtp</code> in publications. Citation should include both the R package and the paper establishing the statistical methodolgy.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">@</span>Manual{,</span>
<span id="cb6-2"><a href="#cb6-2"></a>    title =<span class="st"> </span>{lmtp<span class="op">:</span><span class="st"> </span>{Non}<span class="op">-</span>parametric {Causal} {Effects} of {Feasible} {Interventions} {Based} on {Modified} {Treatment} {Policies}},</span>
<span id="cb6-3"><a href="#cb6-3"></a>    author =<span class="st"> </span>{Nicholas T Williams and Iván Díaz},</span>
<span id="cb6-4"><a href="#cb6-4"></a>    year =<span class="st"> </span>{<span class="dv">2020</span>},</span>
<span id="cb6-5"><a href="#cb6-5"></a>    note =<span class="st"> </span>{R package version <span class="dv">0</span>.<span class="fl">0.91</span>},</span>
<span id="cb6-6"><a href="#cb6-6"></a>    url =<span class="st"> </span>{https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>nt<span class="op">-</span>williams<span class="op">/</span>lmtp}</span>
<span id="cb6-7"><a href="#cb6-7"></a>}</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="op">@</span>Article{,</span>
<span id="cb6-10"><a href="#cb6-10"></a>    journal =<span class="st"> </span>{arxiv},</span>
<span id="cb6-11"><a href="#cb6-11"></a>    title =<span class="st"> </span>{Non<span class="op">-</span>parametric causal effects based on longitudinal modified treatment policies},</span>
<span id="cb6-12"><a href="#cb6-12"></a>    author =<span class="st"> </span>{Iván Díaz and Nicholas Williams and Katherine L Hoffman and Edward J Schneck},</span>
<span id="cb6-13"><a href="#cb6-13"></a>    year =<span class="st"> </span>{<span class="dv">2020</span>},</span>
<span id="cb6-14"><a href="#cb6-14"></a>    url =<span class="st"> </span>{https<span class="op">:</span><span class="er">//</span>arxiv.org<span class="op">/</span>abs<span class="op">/</span><span class="fl">2006.01366</span>}</span>
<span id="cb6-15"><a href="#cb6-15"></a>}</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Diaz I, Williams N, Hoffman KL, Schenck, EJ (2020). <em>Non-Parametric Causal Effects Based on Longitudinal Modified Treatment Policies</em>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing lmtp</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Nicholas Williams <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1378-4831" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Iván Díaz <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9056-2047" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/nt-williams/lmtp"><img src="https://travis-ci.com/nt-williams/lmtp.svg?token=DA4a53nWMx6q9LisKdRD&amp;branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/nt-williams/lmtp"><img src="https://codecov.io/gh/nt-williams/lmtp/branch/master/graph/badge.svg?token=TFQNTischL" alt="codecov"></a></li>
<li><a href="http://opensource.org/licenses/MIT"><img src="http://img.shields.io/badge/license-MIT-brightgreen.svg" alt="MIT license"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Nicholas Williams, Iván Díaz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
